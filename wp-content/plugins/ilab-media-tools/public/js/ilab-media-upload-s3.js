var ilabMediaS3Uploader=function(a,b,c){this.start=function(){var d=c.type;'application/x-photoshop'==d&&(d='image/psd');var e={action:'ilab_upload_prepare',filename:c.name,type:d};a.post(ajaxurl,e,function(e){if('ready'==e.status){b.updateStatusText('Uploading ...');var f=new FormData;_.each(Object.keys(e.formData),function(a){'key'!=a&&f.append(a,e.formData[a])}),null!=e.cacheControl&&0<e.cacheControl.length&&f.append('Cache-Control',e.cacheControl),null!=e.expires&&f.append('Expires',e.expires),f.append('Content-Type',d),f.append('acl',e.acl),f.append('key',e.key),f.append('file',c),a.ajax({url:e.url,method:'POST',contentType:!1,processData:!1,data:f,xhr:function(){var c=a.ajaxSettings.xhr();return c.upload.onprogress=function(a){b.updateProgress(a.loaded/a.total)},c},success:function(){var c={action:'ilab_upload_import_cloud_file',key:e.key};a.post(ajaxurl,c,function(a){b.itemUploaded('success'==a.status,a)})},error:function(){b.itemUploadError()}})}else b.itemUploadError()})}};ilabMediaUploadItem.prototype.storageUploader=ilabMediaS3Uploader;