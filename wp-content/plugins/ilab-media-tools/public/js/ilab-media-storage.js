function clientRectContainsPoint(a,b,c){return b>=a.left&&b<=a.right&&c>=a.top&&c<=a.bottom}(function(a){var b=function(){a('.info-panel-tabs').each(function(){var b=a(this),c=null,d=null;b.find('li').each(function(){var b=a(this),e=a('#'+b.data('tab-target'));b.hasClass('active')&&(c=b,d=e),b.on('click',function(){c==b||(c.removeClass('active'),d.css({display:'none'}),b.addClass('active'),e.css({display:''}),c=b,d=e)})})});var b=null;a('.info-file-info-size').each(function(){b||(b=a(this))}),a('#ilab-other-sizes').on('change',function(){var c=a('#info-size-'+a(this).val());c!=b&&(b.css({display:'none'}),c.css({display:''}),b=c)}),a('.ilab-info-regenerate-thumbnails').on('click',function(b){var c=a(this);return c.data('imgix-enabled')&&!confirm('You are currently using Imgix, which makes this function rather unnecessary.  Are you sure you want to continue?')?!1:(a(document).trigger('ilab-regeneration-started'),b.preventDefault(),c.css({display:'none'}),a('#ilab-info-regenerate-status').css({display:''}),a.post(ajaxurl,{action:'ilab_media_cloud_regenerate_file',post_id:c.data('post-id')},function(b){c.css({display:''}),a('#ilab-info-regenerate-status').css({display:'none'}),'success'!=b.status&&alert(b.message),a(document).trigger('ilab-regeneration-ended')}),!1)})};b();var c=!0,d=!0,e=a('<div class="ilab-loader-container"><div class="ilab-loader ilab-loader-dark"></div></div>'),f=a('<div id="ilab-media-grid-info-popup" class="hidden" style="left:0px; top:0px;"></div>'),g=a('<div class="ilab-media-grid-info-popup-content"></div>'),h=a('<div class="ilab-media-popup-arrow-left"><div></div></div>'),i=a('<div class="ilab-media-popup-arrow-right"><div></div></div>'),j=null,k=!1;f.append(h),f.append(g),f.append(i),a('body').append(f),a(document).on('mouseenter','img.ilab-s3-logo',function(){var d=Math.max;if(c){var l=a(this),m=this,n=l.data('post-id'),o=l.data('mime-type');'image'==o?f.removeClass('ilab-popup-document'):f.addClass('ilab-popup-document'),k=!1,a('li.attachment').each(function(){var b=a(this);b.data('id')==n?(b.removeClass('info-unfocused'),b.addClass('info-focused')):(b.removeClass('info-focused'),b.addClass('info-unfocused'))}),g.text(''),g.append(e);var p=m.getBoundingClientRect(),q=document.body.scrollTop+(p.top+p.height/2-f.height()/2);q-=28;var r=d(document.documentElement.clientHeight,window.innerHeight||0),s=d(document.documentElement.clientWidth,window.innerWidth||0),t=document.body.scrollTop+r-40,u=0;q+f.height()>t?(u=q+f.height()-t,q=t-f.height()):q<document.body.scrollTop?(u=q-document.body.scrollTop,q=document.body.scrollTop):0>q&&(u=q,q=0);var v=p.left;v+f.width()<s-10?(j=h,h.css({transform:'translateY('+u+'px)'}),f.removeClass('popup-right'),f.addClass('popup-left'),f.css({left:p.left+'px',top:q+'px'})):(j=i,f.removeClass('popup-left'),f.addClass('popup-right'),i.css({transform:'translateY('+u+'px)'}),f.css({left:p.right-f.width()+'px',top:q+'px'})),f.removeClass('hidden'),setTimeout(function(){a.post(ajaxurl,{action:'ilab_s3_get_media_info',id:n},function(c){if(0!=c.length){var d=a(c);g.text(''),g.append(d),b(),setTimeout(function(){k=!0},500)}},'html')},300)}}),a(document).on('mousemove',function(b){if(k&&d){var e=j.get(0).getBoundingClientRect();e.top-=5,e.bottom+=5;var h=g.get(0).getBoundingClientRect(),i=b.pageX,l=b.pageY-document.body.scrollTop;clientRectContainsPoint(e,i,l)||clientRectContainsPoint(h,i,l)||(c=!1,k=!1,f.addClass('hidden'),a('li.attachment').each(function(){var b=a(this);b.removeClass('info-focused'),b.removeClass('info-unfocused')}),setTimeout(function(){c=!0},300))}}),a(document).on('ilab-regeneration-started',function(){d=!1}),a(document).on('ilab-regeneration-ended',function(){d=!0})})(jQuery);